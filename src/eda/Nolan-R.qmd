---
title: "Nolan R"
format: html
execute: 
  echo: false
  warning: false
  error: false
---


```{r}

library(tidyverse)

library(shiny)

```

```{r}
read_csv("../../data/wcmatches.csv")
```



```{r}

read_csv("../../data/brazil_econ 2/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv")

read_csv("../../data/brazil_econ 2/Metadata_Country_API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv")

read_csv("../../data/brazil_econ 2/Metadata_Indicator_API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv")

```


```{r}

gdp_data <- read_csv("../../World Bank Econ Data/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv", skip = 4)


brazil_gdp <- gdp_data |>
  filter(`Country Name` == "Brazil")

brazil_gdp_long <- brazil_gdp |>
  select(-`Country Name`, -`Country Code`, -`Indicator Name`, -`Indicator Code`) |>
  pivot_longer(cols = everything(), names_to = "year", values_to = "gdp_usd") |>
  mutate(
    year = as.integer(year),
    gdp_usd = as.numeric(gdp_usd)
  ) |>
  filter(!is.na(year))

head(brazil_gdp_long)


```

```{r}
brazil_gdp_long <- brazil_gdp_long |>
  mutate(hosted_wc = ifelse(year %in% c(1950, 2014), "Hosted", "Did Not Host"))

# Had to look up how to fill certain columns a specific color. 

ggplot(brazil_gdp_long, aes(x = year, y = gdp_usd, fill = hosted_wc)) + 
  geom_col() + 
  scale_fill_manual(values = c("Hosted" = "#009C3B", "Did Not Host" = "lightgrey")) + 
  labs(title = "Brazil GPD Over Time (USD)", 
       subtitle = "Brazil Hosted the World Cup in 2014",
       x = "Year",
       y = "Brazil's GDP (USD)", 
       fill = "Hosted World Cup") + 
  theme_minimal() 
  

```

Key Takeaways:
- Brazil's economy was on a rapid upward trend from 2002 to 2014 (the year of the World Cup)
- After the world cup, the upward trend was haulted and the GDP decreased. 

Questions: 
- What specifically caused the GDP of Brazil to increase before the World Cup?
- What caused the GDP of Brazil to decrease after hosting the World Cup? 
- Can this be attributed to the World Cup or are other events more impactful?





