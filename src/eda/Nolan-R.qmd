---
title: "Nolan R"
format: html
---


```{r}

library(tidyverse)

library(shiny)

```

```{r}
read_csv("~/Documents/project-tung-tung-tung-sahur/data/wcmatches.csv")
```



```{r}

read_csv("~/Documents/project-tung-tung-tung-sahur/World Bank Econ Data/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv")

read_csv("~/Documents/project-tung-tung-tung-sahur/World Bank Econ Data/Metadata_Country_API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv")

read_csv("~/Documents/project-tung-tung-tung-sahur/World Bank Econ Data/Metadata_Indicator_API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv")

```


```{r}
# Load required libraries
library(tidyverse)

# Load the CSV (adjust the path to your file location)
gdp_data <- read_csv("~/Documents/project-tung-tung-tung-sahur/World Bank Econ Data/API_NY.GDP.MKTP.CD_DS2_en_csv_v2_26433.csv", skip = 4)

# Filter for Brazil
brazil_gdp <- gdp_data %>%
  filter(`Country Name` == "Brazil")

# Remove unnecessary columns and pivot the data
brazil_gdp_long <- brazil_gdp %>%
  select(-`Country Name`, -`Country Code`, -`Indicator Name`, -`Indicator Code`) %>%
  pivot_longer(cols = everything(), names_to = "year", values_to = "gdp_usd") %>%
  mutate(
    year = as.integer(year),
    gdp_usd = as.numeric(gdp_usd)
  ) %>%
  filter(!is.na(year))

# View the cleaned data
print(head(brazil_gdp_long))

```

```{r}
brazil_gdp_long <- brazil_gdp_long |>
  mutate(hosted_wc = ifelse(year %in% c(1950, 2014), "Hosted", "Did Not Host"))

# Had to look up how to fill certain columns a specific color. 

ggplot(brazil_gdp_long, aes(x = year, y = gdp_usd, fill = hosted_wc)) + 
  geom_col() + 
  scale_fill_manual(values = c("Hosted" = "#009C3B", "Did Not Host" = "lightgrey")) + 
  labs(title = "Brazil GPD Over Time (USD)", 
       subtitle = "Brazil Hosted the World Cup in 2014",
       x = "Year",
       y = "Brazil's GDP (USD)", 
       fill = "Hosted World Cup") + 
  theme_minimal() 
  

```

Key Takeaways:
- Brazil's economy was on a rapid upward trend from 2002 to 2014 (the year of the World Cup)
- After the world cup, the upward trend was haulted and the GDP decreased. 

Questions: 
- What specifically caused the GDP of Brazil to increase before the World Cup?
- What caused the GDP of Brazil to decrease after hosting the World Cup? 
- Can this be attributed to the World Cup or are other events more impactful?



